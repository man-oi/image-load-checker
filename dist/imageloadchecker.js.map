{"version":3,"sources":["imageloadchecker.js"],"names":["ImageLoadChecker","options","_","defaults","imageSelector","timeoutTime","imageLoaded","element","classList","add","imageLoadedAfterTimeout","imageError","imageErrorAfterTimeout","imageTimeout","imageElements","timeoutFunctions","timeouts","loadedImages","errorImages","timeoutImages","init","console","log","extend","document","querySelectorAll","bindEvents","event","createEvent","i","length","addEventListener","loaded","error","window","setTimeout","timeout","complete","naturalWidth","initEvent","dispatchEvent","e","target","src","key","Array","prototype","slice","call","indexOf","clearTimeout","removeEventListener","allLoaded","notAllLoaded","allFails","destination","property"],"mappings":"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","sourcesContent":["const ImageLoadChecker = (() => {\n    'use strict'\n\n    return function (options) {\n        const _ =  {};\n        _.defaults = {\n            imageSelector: 'img',\n            timeoutTime: 1000 * 60,\n            imageLoaded(element) {\n                element.classList.add('loaded');\n            },\n            imageLoadedAfterTimeout(element) {\n                element.classList.add('loaded');\n            },\n            imageError(element) {\n                element.classList.add('error');\n            },\n            imageErrorAfterTimeout(element) {\n                element.classList.add('error');\n            },\n            imageTimeout(element) {\n              element.classList.add('loaded-timeout');\n            }\n        };\n        _.options = {};\n        _.imageElements = null;\n        _.timeoutFunctions = [];\n        _.timeouts = [];\n        _.loadedImages = 0;\n        _.errorImages = 0;\n        _.timeoutImages = 0;\n\n\n        _.init = function() {\n            console.log('init');\n            if (options === undefined) {\n                options = {};\n            }\n            _.extend(_.options, _.defaults, options);\n\n            _.imageElements = document.querySelectorAll(_.options.imageSelector);\n\n            _.bindEvents();\n        }\n\n        _.bindEvents = function() {\n            const event = document.createEvent(\"HTMLEvents\");\n\n            for (let i = 0; i < _.imageElements.length; i++) {\n                _.imageElements[i].addEventListener('load', _.loaded);\n                _.imageElements[i].addEventListener('error', _.error);\n\n                _.timeoutFunctions[i] = window.setTimeout((i) => {\n                    _.timeout(_.imageElements[i])\n                }, _.options.timeoutTime, i);\n                _.timeouts[i] = false;\n\n\n                if (_.imageElements[i].complete) {\n                    if (_.imageElements[i].naturalWidth  === 0) {\n                        event.initEvent(\"error\", true, true);\n                    }\n                    else {\n                        event.initEvent(\"load\", true, true);\n                    }\n\n                    _.imageElements[i].dispatchEvent(event);\n                }\n            }\n        }\n\n\n\n        /*\n            Image Events\n        */\n        _.loaded = function(e) {\n            console.log('loaded: ' + e.target.src);\n            var element = e.target;\n            var key = Array.prototype.slice.call(_.imageElements).indexOf(element);\n\n            window.clearTimeout(_.timeoutFunctions[key]);\n            element.removeEventListener('load', _.loaded);\n\n            if (!_.timeouts[key]) {\n                _.loadedImages++;\n                _.options.imageLoaded(element);\n\n                if (_.loadedImages + _.errorImages + _.timeoutImages === _.imageElements.length) {\n                    if (_.loadedImages === _.imageElements.length) {\n                        _.allLoaded();\n                    }\n                    else {\n                        _.notAllLoaded();\n                    }\n                }\n            }\n            else {\n                _.options.imageLoadedAfterTimeout(element);\n            }\n        },\n\n        _.error = function(e) {\n            const element = e.target;\n            const key = Array.prototype.slice.call(_.imageElements).indexOf(element);\n\n            window.clearTimeout(_.timeoutFunctions[key]);\n            element.removeEventListener('error', _.error);\n\n            if (!_.timeouts[key]) {\n                _.errorImages++;\n                _.options.imageError(element);\n\n                if (_.loadedImages + _.errorImages + _.timeoutImages === _.imageElements.length) {\n                    if (_.errorImages === _.imageElements.length) {\n                        _.allFails();\n                    }\n                    else {\n                        _.notAllLoaded();\n                    }\n                }\n            }\n            else {\n                _.options.imageErrorAfterTimeout(element);\n            }\n        }\n\n        _.timeout = function(element) {\n            const key = Array.prototype.slice.call(_.imageElements).indexOf(element);\n\n            _.timeouts[key] = true;\n            _.timeoutImages++;\n\n            _.options.imageTimeout(element);\n\n            if (_.loadedImages + _.errorImages + _.timeoutImages === _.imageElements.length) {\n                if (_.errorImages === _.imageElements.length) {\n                    _.allFails();\n                }\n                else {\n                    _.notAllLoaded();\n                }\n            }\n        }\n\n\n\n        /*\n            Collection Events\n        */\n        _.allFails = function() {\n            console.log('all fails');\n        },\n\n        _.allLoaded = function() {\n            console.log('all loaded');\n        },\n\n        _.notAllLoaded = function() {\n            console.log('not all loaded, just ' + _.loadedImages + ' of ' + _.imageElements.length);\n        },\n\n\n\n        /*\n            Helper Functions\n        */\n        _.extend = function(destination, defaults, options) {\n            for (var property in defaults) {\n                if (options[property]) {\n                    destination[property] = options[property];\n                }\n                else {\n                    destination[property] = defaults[property];\n                }\n            }\n            return destination;\n        };\n\n        _.init();\n    }\n})();\n"],"file":"imageloadchecker.js"}